%Define Parameterslen = 100; %meterdep = 1;   %meterwid = 5;   %meterU = 0.1;   %m/s mean flow velocity / advective coefficientD = 0.01;  %m2/s dispersion coefficientdx = 0.1;dt = 0.1; s_time = 1200;riverSize = len / dx;volumeOfRiver = wid * dep  * len;volumeOfDxRiver  = wid * dep * dx;wieghtOfTracer = 1; % amount of injected tracer 1kgCa = U * dt / dx;Cd = D * dt / (dx * dx);C_j = zeros(riverSize,s_time / dt); %second dimension is responsible for timeC_j(10/dx,1) = wieghtOfTracer / volumeOfDxRiver;% location of the injection point 10m at the begining of the simulationfor n=1:s_time/dt - 1    for j=3:riverSize-1        C_j(j,n+1) = C_j(j,n) + (Cd*(1-Ca) - (Ca/6)*(Ca*Ca - 3*Ca + 2))*C_j(j+1,n) - (Cd*(2 - 3*Ca) - (Ca/2)*(Ca*Ca - 2*Ca - 1))*C_j(j,n) + (Cd*(1 - 3*Ca) - (Ca/2)*(Ca*Ca - Ca - 2))*C_j(j-1,n) + (Cd*Ca + (Ca/6)*(Ca*Ca - 1))*C_j(j-2,n);    endend%%plot1Data = C_j(90/dx,:); %90 - location of measurementfigure();plot(plot1Data);xt = get(gca, 'XTick');                                set(gca, 'XTick', xt, 'XTickLabel', xt*dt)  xlabel('Time [s]');ylabel('Tracer concentration');title('Tracer concentration in 90m of the river');figure();plot2Data = zeros(s_time / dt , 1);for n  = 1: s_time / dt;    plot2Data(n) = sum(C_j(:,n)) * volumeOfRiver;end plot(plot2Data);xt = get(gca, 'XTick');                                set(gca, 'XTick', xt, 'XTickLabel', xt*dt)  xlabel('Time [s]');ylabel('Total mass [g]');title('Total mass of the tracer in the river');